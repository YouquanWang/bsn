{"version":3,"sources":["webpack:///./src/views/list/pool.vue","webpack:///./src/views/list/pool.vue?e07d","webpack:///./src/views/list/pool.vue?51c4"],"names":["class","left-arrow","title","$goBack","records","item","dayNum","canReceive","setup","store","data","address","state","accounts","web3","provider","BsnContract","windTokenContract","initContract","eth","Contract","BSNAbi","config","BsnAddress","windToken","initData","getList","methods","decimals","call","getPastEvents","filter","_user","fromBlock","toBlock","result","arr","forEach","console","log","params","user","returnValues","_dayNum","_canReceive","dividedBy","Math","pow","toFixed","push","val","refData","render","__scopeId"],"mappings":"sNACOA,MAAM,0B,GAKJA,MAAM,Q,GACJA,MAAM,oB,GACJA,MAAM,a,GACJA,MAAM,Y,EACT,eAA8B,OAAzBA,MAAM,SAAQ,SAAK,G,GACnBA,MAAM,kB,GAERA,MAAM,Y,EACT,eAA8B,OAAzBA,MAAM,SAAQ,SAAK,G,GACnBA,MAAM,kB,4GAdrB,eAoBM,MApBN,EAoBM,CAnBJ,eAG0B,GAFxBC,aAAA,GACAC,MAAM,SACL,YAAY,EAAAC,S,wBACf,eAcM,MAdN,EAcM,CAbJ,eAYM,MAZN,EAYM,E,mBAXJ,eASM,2BATgC,EAAAC,SAAO,SAAfC,G,wBAA9B,eASM,MATN,EASM,CARJ,eAGM,MAHN,EAGM,CAFJ,EACA,eAAiD,MAAjD,EAAiD,eAAnBA,EAAKC,QAAM,KAE3C,eAGM,MAHN,EAGM,CAFJ,EACA,eAAgE,MAAhE,EAAgE,eAAlCD,EAAKE,YAAY,cAAW,U,4IAiBvD,GACbC,MADa,WAEX,IAAMC,EAAQ,iBACRC,EAAO,eAAS,CACpBN,QAAS,GACTO,QAAS,gBAAS,kBAAMF,EAAMG,MAAMC,SAAS,MAC7CC,KAAM,gBAAS,kBAAML,EAAMG,MAAMG,YACjCC,YAAa,KACbC,kBAAmB,KACnBC,aAAc,WACZR,EAAKM,YAAc,IAAIN,EAAKI,KAAKK,IAAIC,SAASC,EAAQC,EAAA,KAAOC,YAC7Db,EAAKO,kBAAoB,IAAIP,EAAKI,KAAKK,IAAIC,SAAS,EAAUE,EAAA,KAAOE,WACrEd,EAAKe,YAEPA,SAAU,WACRf,EAAKgB,WAEPA,QAAS,WAAF,8CAAE,wHACahB,EAAKO,kBAAkBU,QAAQC,WAAWC,OADvD,cACJD,EADI,gBAEYlB,EAAKM,YAAYc,cAAc,mBAAoB,CAClEC,OAAQ,CAACC,MAAO,CAACtB,EAAKC,UACtBsB,UAAW,EACXC,QAAS,WALN,OAEJC,EAFI,OAOHC,EAAM,GACVD,EAAOE,SAAQ,SAAChC,GACdiC,QAAQC,IAAIlC,GACZ,IAAImC,EAAS,CACXC,KAAMpC,EAAKqC,aAAaV,MACxB1B,OAAQD,EAAKqC,aAAaC,QAC1BpC,WAAY,IAAI,IAAUF,EAAKqC,aAAaE,aAAaC,UAAUC,KAAKC,IAAI,GAAInB,IAAWoB,QAAQ,IAErGZ,EAAIa,KAAKT,MAEX9B,EAAKN,QAAUgC,EAjBR,2CAAF,qDAAE,KAoBP1B,EAAKC,SACPD,EAAKQ,eAEN,gBAAM,kBAAMR,EAAKC,WAAS,SAACuC,GACtBA,GACFxC,EAAKQ,kBAGT,IAAMiC,EAAU,eAAOzC,GACvB,yBACKyC,K,UC1ET,EAAOC,OAASA,EAChB,EAAOC,UAAY,kBAEJ,gB,oCCRf,W","file":"static/js/chunk-3b0adfe1.e0a2f8c8.js","sourcesContent":["<template>\r\n  <div class=\"container bg-container\">\r\n    <van-nav-bar\r\n      left-arrow\r\n      title=\"矿池分红记录\"\r\n      @click-left=\"$goBack\" />\r\n    <div class=\"list\">\r\n      <div class=\"item flex-middle\">\r\n        <div class=\"flex-item\" v-for=\"item in records\">\r\n          <div class=\"flex row\">\r\n            <div class=\"label\">结算周期：</div>\r\n            <div class=\"flex-item cont\">{{item.dayNum}}</div>\r\n          </div>\r\n          <div class=\"flex row\">\r\n            <div class=\"label\">结算数量：</div>\r\n            <div class=\"flex-item cont\">{{item.canReceive}} Wind Token</div>\r\n          </div>\r\n        </div>\r\n        <!-- <div class=\"num c-2FBBA1\">+666.00BUSD</div> -->\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// import { Toast } from 'vant';\r\nimport { reactive, toRefs, computed, watch} from \"vue\";\r\nimport BSNAbi from \"@/utils/BSNAbi\";\r\nimport tokenAbi from \"@/utils/abi\";\r\nimport config from \"@/utils/config\";\r\nimport {useStore} from \"vuex\";\r\nimport Bignumber from \"bignumber.js\";\r\nexport default {\r\n  setup () {\r\n    const store = useStore()\r\n    const data = reactive({\r\n      records: [],\r\n      address: computed(() => store.state.accounts[0]),\r\n      web3: computed(() => store.state.provider),\r\n      BsnContract: null,\r\n      windTokenContract: null,\r\n      initContract: () => {\r\n        data.BsnContract = new data.web3.eth.Contract(BSNAbi, config.BsnAddress)\r\n        data.windTokenContract = new data.web3.eth.Contract(tokenAbi, config.windToken)\r\n        data.initData()\r\n      },\r\n      initData: () => {\r\n        data.getList()\r\n      },\r\n      getList: async () => {\r\n       let decimals = await data.windTokenContract.methods.decimals().call();\r\n       let result =  await data.BsnContract.getPastEvents('ReceiveDividends', {\r\n            filter: {_user: [data.address]}, // Using an array means OR: e.g. 20 or 23\r\n            fromBlock: 0,\r\n            toBlock: 'latest'\r\n        })\r\n        let arr = [];\r\n        result.forEach((item) => {\r\n          console.log(item)\r\n          let params = {\r\n            user: item.returnValues._user,\r\n            dayNum: item.returnValues._dayNum,\r\n            canReceive: new Bignumber(item.returnValues._canReceive).dividedBy(Math.pow(10, decimals)).toFixed(3)\r\n          }\r\n          arr.push(params)\r\n        })\r\n        data.records = arr;\r\n      }\r\n    })\r\n    if (data.address) {\r\n      data.initContract()\r\n    }\r\n     watch(() => data.address, (val) => {\r\n      if (val) {\r\n        data.initContract()\r\n      }\r\n    })\r\n    const refData = toRefs(data);\r\n    return {\r\n      ...refData\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.list {\r\n  margin: 15px;\r\n  border-radius: 25px;\r\n  background: #fff;\r\n  padding: 20px 15px;\r\n  .item {\r\n    background: #EEEAF4;\r\n    border-radius: 13px;\r\n    padding: 13px 12px;\r\n    color: #8F80BA;\r\n    .row + .row {\r\n      margin: 6px 0 0;\r\n    }\r\n    .cont {\r\n      word-break: break-all;\r\n    }\r\n    .num {\r\n      font-size: 15px;\r\n      font-weight: bold;\r\n    }\r\n  }\r\n  .item + .item {\r\n    margin-top: 15px;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./pool.vue?vue&type=template&id=09b86ba6&scoped=true\"\nimport script from \"./pool.vue?vue&type=script&lang=js\"\nexport * from \"./pool.vue?vue&type=script&lang=js\"\n\nimport \"./pool.vue?vue&type=style&index=0&id=09b86ba6&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-09b86ba6\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./pool.vue?vue&type=style&index=0&id=09b86ba6&lang=less&scoped=true\""],"sourceRoot":""}